---
title: "usage"
bg: '#C02942'
color: white
fa-icon: check-square-o
---

# How to use MoCa QR on an election

We will explain the use of each of the applications separated in the three actors that are present at the moment of running an election: administrators, authorities and voters.

## Election Administrators - [Administrator App](https://www.github.com/niclabs/moca-administrator-app)

1. Bulletin Board configuration: the BB needs to be configured in the way is described above, so all the applications can download and upload the public values with no problems.

2. Candidates List: the administrators need to establish the list of the candidates that will run on this election. *This functionality will be present at Administrator App. For now the candidates list file needs to be edited separately.*

3. Run Authority Key Generation: before the election, is necessary that the administrators run [this application](https://www.github.com/niclabs/moca-auth-keys-generator), with the authorities present. With this, the public key will be uploaded to the BB and each authority will store their private key on their mobile phones.

4. Run Voter Key Generation: also before the election, is necessary that all the persons that are entitled to vote, had to generate their key pair for the signature of the encrypted ballot. The idea is to run this generation of keys a while ago the election, so the voters can do it with time. Every time a voter generates their key pair, the public value is uploaded to the BB and the private is stored on their mobile phones using [Voter App](https://www.github.com/niclabs/moca-voter-app).

5. Deliver public values to machines with no access to BB: there are some machines that are not allowed to have connection to the BB for security issues. This machines are [Ballot Selection](https://www.github.com/niclabs/moca-ballot-selection) and [Ballot Verification](https://www.github.com/niclabs/moca-ballot-verification). The administrators need to make sure that each of the machines will have access to some public values (authority public key and candidates list) in their file system, so they can be configured using this values. 

6. Configure all machines: all the machines need to be configured with, at least, the address of the BB, so they can download all the public information necessary to run their specific function on the election.

7. Generate ballots multiplication value: at the end of the election, is necessary to generate the multiplication of all the ballots (to use the homomorphic property of Paillier). This task could be done by any person, because all the values are public and is just a simple operation with all the encrypted ballots present on the BB. To make sure this value will be calculated, the administrators need to do it. For more transparency, there could be more persons calculating this value. *This functionality will be present at Administrator App.*

8. Combine Partial Decryptions: when all the partial decryptions (or at least the necessary to reach the threshold) are present on the BB, is necessary to combine them to decrypt the final result of the election. Once again this could be done by any person, because the values are all public and also the application to do it. With this the final outcome is revealed and the election is over. *A Web Application is being developed right now to perform this task.*

<br/>
 
## Election Authorities - [Authority App](https://www.github.com/niclabs/moca-authority-app)

1. Store their share of the private key: at the moment of thekey pair generator of the authorities, each of them needs to store their share of the private key (threshold system) in their mobile phones. This is done right now storing the file on an external storage (e.g. SD card), and then configuring AuthorityApp to use that file as the share to decrypt the value at the end of the election.

2. Decrypt the multiplication of the ballots: at the end of the election, when the multiplication of the ballots is calculated, each of the authorities need to use their AuthorityApp to decrypt this value, and generate their partial decryption. This partial decryption is uploaded to the BB waiting to gather enough of them (threshold) for the administrators to combine them and reveal the outcome of the election.

<br/>

## Voters - [Voter App](https://www.github.com/niclabs/moca-voter-app)

1. Store their private key: in order to sign the encryption, the voters need to go to generate their key pair, and then store their private key using VoterApp. This process consists on scanning the QR code generated by [Voter Keys Generation](https://www.github.com/niclabs/moca-voter-keys-generator) and is stored automatically within the application.

2. Operate with [Ballot Selection](https://www.github.com/niclabs/moca-ballot-selection): the voter when arrives to the polling station, needs to go to the voting booth and operate with Ballot Selection (tablet). With this application, the voter selects her candidates, and then needs to sign the encryption generated. For this,needs to use VoterApp, and exchange QR codes with the tablet, using the camera (in the video below this process is more clear). After this, the machine prints the ballot with the three parts.

3. Verify the encryption: after priting the ballot, within the same voting booth, the voter needs to verify the encryption produced. For this, the voter needs to use [Ballot Verification](https://www.github.com/niclabs/moca-ballot-verification) and scan both QR codes printed in the ballot. If the machine answers that the encrypted candidate is the same that the voter intended to vote, she has to fold the first part of the ballot to hide the human-readable part and leave out the voting booth. If is not the same candidate, she can go back to Ballot Selection and print a new ballot.

4. Cast her ballot: after leaving the voting booth, she must hand out the ballot to the poll worker, who destroys the third part of the ballot (QR code containing the randomness), then scans the second QR code (encryption) using [Ballot Casting](https://www.github.com/niclabs/moca-ballot-casting), the system uploads this value to the BB (after the verification of the signature), and the poll worker detaches the first part of the ballot handing it back to the voter. She deposits this part on an urn, and can go home with the second part of the ballot.

5. Verify that her vote will/was be counted: the voter can check if her vote is present on the BB using the part of the ballot that carried home. This can be done before the end of the election, or even days passed the election was over, because is public information and must be available for all the persons. *This functionality will be present at Voter App.*